{% extends "base.html" %}

{% block title %}–î–Ω–µ–≤–µ–Ω –ó–∞–ø–∏—Å - –ú–µ–Ω—Ç–∞–ª–Ω–æ–ó–¥—Ä–∞–≤—ò–µ{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <!-- Header -->
    <div class="text-center mb-8">
        <div class="text-6xl mb-4">üìî</div>
        <h1 class="text-4xl font-bold text-purple-800 mb-2">–î–Ω–µ–≤–µ–Ω –∑–∞–ø–∏—Å</h1>
        <p class="text-purple-600 text-lg">{{ entry.date.strftime('%d.%m.%Y') }}</p>
    </div>

    <!-- Daily Question Card -->
    <div class="card mb-8 bg-gradient-to-r from-purple-50 to-purple-100 border-purple-200">
        <div class="flex items-start space-x-4">
            <div class="text-3xl">üí≠</div>
            <div class="flex-1">
                <h2 class="text-xl font-semibold text-purple-800 mb-3">–ü—Ä–∞—à–∞—ö–µ –Ω–∞ –¥–µ–Ω–æ—Ç</h2>
                <p class="text-purple-700 text-lg leading-relaxed">{{ entry.question }}</p>
            </div>
        </div>
    </div>

    <!-- Journal Form -->
    <form id="journal-form" class="space-y-6">
        <!-- Answer to daily question -->
        <div class="card">
            <label class="block text-lg font-semibold text-purple-800 mb-3">
                üí¨ –¢–≤–æ—ò –æ–¥–≥–æ–≤–æ—Ä
            </label>
            <textarea
                name="answer"
                  class="w-full px-4 py-3 rounded-2xl border border-purple-300 bg-white focus:ring-2 focus:ring-purple-400 focus:outline-none shadow-sm transition duration-200"

                placeholder="–°–ø–æ–¥–µ–ª–∏ –≥–∏ —Ç–≤–æ–∏—Ç–µ –º–∏—Å–ª–∏..."
            >{{ entry.answer or '' }}</textarea>
        </div>

        <!-- Gratitude Section -->
        <div class="card">
            <h3 class="text-xl font-semibold text-purple-800 mb-4 flex items-center">
                üôè –ó–∞ —à—Ç–æ —Å–∏ –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω/–Ω–∞ –¥–µ–Ω–µ—Å?
            </h3>
            <div class="space-y-4">
                <div>
                    <input
                        type="text"
                        name="gratitude_1"
                            class="w-full px-4 py-3 rounded-2xl border border-purple-300 bg-white focus:ring-2 focus:ring-purple-400 focus:outline-none shadow-sm transition duration-200"

                        placeholder="1. –ù–µ—à—Ç–æ –º–∞–ª–æ —à—Ç–æ —Ç–µ –Ω–∞–ø—Ä–∞–≤–∏ —Å—Ä–µ—ú–µ–Ω/–Ω–∞"
                        value="{{ entry.gratitude_1 or '' }}"
                    >
                </div>
                <div>
                    <input
                        type="text"
                        name="gratitude_2"
                            class="w-full px-4 py-3 rounded-2xl border border-purple-300 bg-white focus:ring-2 focus:ring-purple-400 focus:outline-none shadow-sm transition duration-200"

                        placeholder="2. –ù–µ–∫–æ—ò –∫–æ—ò —Ç–∏ –ø–æ–º–æ–≥–Ω–∞ –∏–ª–∏ —Ç–µ –≤–æ–æ–¥—É—à–µ–≤–∏"
                        value="{{ entry.gratitude_2 or '' }}"
                    >
                </div>
                <div>
                    <input
                        type="text"
                        name="gratitude_3"
                            class="w-full px-4 py-3 rounded-2xl border border-purple-300 bg-white focus:ring-2 focus:ring-purple-400 focus:outline-none shadow-sm transition duration-200"

                        placeholder="3. –ò—Å–∫—É—Å—Ç–≤–æ –∏–ª–∏ –º–æ–º–µ–Ω—Ç –∫–æ—ò –≥–æ —Ü–µ–Ω–∏—à"
                        value="{{ entry.gratitude_3 or '' }}"
                    >
                </div>
            </div>
        </div>

        <!-- Highlight & Challenge -->
        <div class="grid md:grid-cols-2 gap-6">
            <div class="card">
                <label class="block text-lg font-semibold text-purple-800 mb-3">
                    ‚≠ê –ù–∞—ò–¥–æ–±—Ä–æ –æ–¥ –¥–µ–Ω–æ–≤
                </label>
                <textarea
                    name="highlight"
    class="w-full px-4 py-3 rounded-2xl border border-purple-300 bg-white focus:ring-2 focus:ring-purple-400 focus:outline-none shadow-sm transition duration-200"
                    placeholder="–®—Ç–æ –±–µ—à–µ –Ω–∞—ò—É–±–∞–≤–æ—Ç–æ –≤–æ —Ç–≤–æ—ò–æ—Ç –¥–µ–Ω?"
                >{{ entry.highlight or '' }}</textarea>
            </div>

            <div class="card">
                <label class="block text-lg font-semibold text-purple-800 mb-3">
                    üí™ –ü—Ä–µ–¥–∏–∑–≤–∏–∫ –∫–æ—ò –≥–æ —Å–æ–≤–ª–∞–¥–∞
                </label>
                <textarea
                    name="challenge"
    class="w-full px-4 py-3 rounded-2xl border border-purple-300 bg-white focus:ring-2 focus:ring-purple-400 focus:outline-none shadow-sm transition duration-200"
                    placeholder="–ö–∞–∫–æ —Å–µ —Å–ø—Ä–∞–≤–∏ —Å–æ —Ç–µ—à–∫–æ—Ç–∏–∏—Ç–µ?"
                >{{ entry.challenge or '' }}</textarea>
            </div>
        </div>

        <!-- Tomorrow Goal -->
        <div class="card">
            <label class="block text-lg font-semibold text-purple-800 mb-3">
                üéØ –¶–µ–ª –∑–∞ —É—Ç—Ä–µ
            </label>
            <input
                type="text"
                name="tomorrow_goal"
                    class="w-full px-4 py-3 rounded-2xl border border-purple-300 bg-white focus:ring-2 focus:ring-purple-400 focus:outline-none shadow-sm transition duration-200"

                placeholder="–®—Ç–æ —Å–∞–∫–∞—à –¥–∞ –ø–æ—Å—Ç–∏–≥–Ω–µ—à —É—Ç—Ä–µ?"
                value="{{ entry.tomorrow_goal or '' }}"
            >
        </div>

        <!-- Energy & Stress Levels -->
        <div class="grid md:grid-cols-2 gap-6">
            <div class="card">
                <label class="block text-lg font-semibold text-purple-800 mb-4">
                    ‚ö° –ù–∏–≤–æ –Ω–∞ –µ–Ω–µ—Ä–≥–∏—ò–∞
                </label>
                <div class="flex items-center space-x-2">
                    <span class="text-sm text-purple-600">–ù–∏—Å–∫–æ</span>
                    <input
                        type="range"
                        name="energy_level"
                        min="1"
                        max="10"
                        value="{{ entry.energy_level or 5 }}"
                        class="flex-1 h-2 bg-purple-200 rounded-lg appearance-none cursor-pointer"
                        id="energy-slider"
                    >
                    <span class="text-sm text-purple-600">–í–∏—Å–æ–∫–æ</span>
                </div>
                <div class="text-center mt-2">
                    <span class="text-lg font-semibold text-purple-700" id="energy-value">{{ entry.energy_level or 5 }}</span>
                </div>
            </div>

            <div class="card">
                <label class="block text-lg font-semibold text-purple-800 mb-4">
                    üò∞ –ù–∏–≤–æ –Ω–∞ —Å—Ç—Ä–µ—Å
                </label>
                <div class="flex items-center space-x-2">
                    <span class="text-sm text-purple-600">–ù–∏—Å–∫–æ</span>
                    <input
                        type="range"
                        name="stress_level"
                        min="1"
                        max="10"
                        value="{{ entry.stress_level or 5 }}"
                        class="flex-1 h-2 bg-purple-200 rounded-lg appearance-none cursor-pointer"
                        id="stress-slider"
                    >
                    <span class="text-sm text-purple-600">–í–∏—Å–æ–∫–æ</span>
                </div>
                <div class="text-center mt-2">
                    <span class="text-lg font-semibold text-purple-700" id="stress-value">{{ entry.stress_level or 5 }}</span>
                </div>
            </div>
        </div>

        <!-- Save Button -->
        <div class="text-center pt-6">
            <button type="submit"     class="bg-gradient-to-r from-purple-500 to-purple-700 text-white font-semibold rounded-full shadow-lg hover:shadow-xl hover:from-purple-600 hover:to-purple-800 transition-all duration-300 px-8 py-4"
>
                üíæ –ó–∞—á—É–≤–∞—ò –∑–∞–ø–∏—Å
            </button>
        </div>
    </form>

    <!-- Quick Actions -->
    <div class="flex flex-wrap justify-center gap-4 mt-8">
        <a href="{{ url_for('journal.history') }}" class="btn-secondary">
            üìö –ü–æ–≥–ª–µ–¥–∞—ò –∏—Å—Ç–æ—Ä–∏—ò–∞
        </a>
        <a href="{{ url_for('journal.prompts') }}" class="btn-secondary">
            üí° –ò–Ω—Å–ø–∏—Ä–∞—Ü–∏—ò–∞ –∑–∞ –ø–∏—à—É–≤–∞—ö–µ
        </a>
        <a href="{{ url_for('mood.index') }}" class="btn-secondary">
            üòä –í–Ω–µ—Å–∏ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ
        </a>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
    // Update slider values
    const energySlider = document.getElementById('energy-slider');
    const energyValue = document.getElementById('energy-value');
    const stressSlider = document.getElementById('stress-slider');
    const stressValue = document.getElementById('stress-value');

    energySlider.addEventListener('input', function() {
        energyValue.textContent = this.value;
    });

    stressSlider.addEventListener('input', function() {
        stressValue.textContent = this.value;
    });

    // Form submission
    document.getElementById('journal-form').addEventListener('submit', async function(e) {
        e.preventDefault();

        const formData = new FormData(this);
        const data = Object.fromEntries(formData.entries());

        const result = await apiCall('{{ url_for("journal.save_entry") }}', data);

        if (result.success) {
            showNotification(result.message, 'success');
        } else {
            showNotification(result.message, 'error');
        }
    });

    // Auto-save every 30 seconds
    setInterval(async function() {
        const form = document.getElementById('journal-form');
        const formData = new FormData(form);
        const data = Object.fromEntries(formData.entries());

        // Check if there's any content to save
        const hasContent = Object.values(data).some(value => value.trim() !== '');

        if (hasContent) {
            await apiCall('{{ url_for("journal.save_entry") }}', data);
        }
    }, 30000);
</script>

<style>
    /* Custom range slider styles */
    input[type="range"]::-webkit-slider-thumb {
        appearance: none;
        height: 20px;
        width: 20px;
        border-radius: 50%;
        background: #9333ea;
        cursor: pointer;
        box-shadow: 0 0 2px 0 #555;
        transition: background .15s ease-in-out;
    }

    input[type="range"]::-webkit-slider-thumb:hover {
        background: #7c3aed;
    }

    input[type="range"]::-moz-range-thumb {
        height: 20px;
        width: 20px;
        border-radius: 50%;
        background: #9333ea;
        cursor: pointer;
        border: none;
        box-shadow: 0 0 2px 0 #555;
    }

    input[type="range"]::-moz-range-thumb:hover {
        background: #7c3aed;
    }
</style>
{% endblock %}